# -*- coding: utf-8 -*-
"""yersa arain

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1MGU81tt9jX7t2TgpoHcv6z4oUrpF-nxT
"""

!pip install tensorflow
!pip install keras

import numpy as np
import pandas as pd
import tensorflow as tf
from tensorflow.keras import datasets,layers,models
import matplotlib.pyplot as plt

(xtrain,ytrain),(xtest,ytest)=datasets.cifar10.load_data()

ytest=ytest.reshape(-1,)
ytest

classname=["airplane","automobile","bird","cat","deer","dog","frog","horse","ship","truck"]

def example(x,y,index):
    plt.figure(figsize=(15,2))
    plt.imshow(x[index])
    plt.xlabel(classname[y[index]])

#x: Dataset containing the images.
#y: Dataset containing the labels. Specifies the class of each image.
#index: Specify the index of the data point to be visualized

example(xtest,ytest,8)

xtrain=xtrain/255
xtest=xtest/255

from keras.layers import *
model = models.Sequential([
    Input(shape=(32,32,3)),  # InputLayer'Ä± buraya ekleyin
    layers.Conv2D(filters=32, kernel_size=(3,3), activation='relu'),
    layers.MaxPooling2D(2,2),

    layers.Conv2D(filters=64, kernel_size=(3,3), activation='relu'),
    layers.MaxPooling2D(2,2),

    layers.Flatten(),
    layers.Dense(64, activation="relu"),
    layers.Dense(10, activation="softmax")
])

model.compile(optimizer="adam",
              loss="sparse_categorical_crossentropy",
              metrics=["accuracy"])

history=model.fit(xtrain,ytrain,epochs=30, validation_data=(xtest,ytest))

loss,acc= model.evaluate(xtest,ytest,verbose=False)

plt.figure(figsize=(20,5))
plt.subplot(1,2,1)
plt.plot(history.history['accuracy'],color = "b",label= "Training Accuracy")
plt.plot(history.history["val_accuracy"], color = "r", label = "Validation Accuracy")
plt.legend(loc = "lower right")
plt.xlabel("Epoch", fontsize= 16)
plt.ylabel("Accuracy",fontsize = 16)
plt.ylim([min(plt.ylim()),1])
plt.title("Training and Test Performance Graph", fontsize = 16)

plt.figure(figsize= (20,5))
plt.subplot(1,2,2)
plt.plot(history.history["loss"],color= "b",label="Training Loss")
plt.plot(history.history["val_loss"],color="r",label="Validation Loss")
plt.legend(loc= "upper right")
plt.xlabel("Epoch",fontsize=16)
plt.ylabel("Loss",fontsize = 16)
plt.ylim([0,max(plt.ylim())])
plt.title("Training and Test Loss Graph",fontsize= 16)
plt.show()

ypred=model.predict(xtest)
ypred[:3]

ypred1=[np.argmax(element) for element in ypred]
ypred1[:3]

# True classes
y_true = [3, 8, 8, 0]

# Predicted classes
ypred1 = [3, 8, 1, 0]

# Printing the true and predicted classes
for true, pred in zip(y_true[:3], ypred1[:3]):
    print("True Class:", classname[true], "\tPredicted Class:", classname[pred])